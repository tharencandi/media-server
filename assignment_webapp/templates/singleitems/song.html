{% include 'top.html' %}
<div class="content">
    <div class="container details">
        <!-- Check if We have a valid song -->
        {% if song | length > 0 %}
            <h2 class="title"> {{song[0].song_title}} by {{song[0].artists}}</h2>
            <br/>
            Song is {{song[0].length}} seconds long.
            <hr/>
            <h3> Artworks </h3>
            {% for instance in songmetadata %}
                {% if instance.md_type_name == 'artwork' %}
                    <img src="{{instance.md_value}}" alt="image">
                    <br/>Â© Spotify Public Domain 2019.
                {% endif %}
            {% endfor %}
            <br/>
            <h3> Descriptions </h3>
            {% for instance in songmetadata %}
                {% if instance.md_type_name == 'description' %}
                    <div>
                        {{instance.md_value}}
                    </div>
                {% endif %}
            {% endfor %}
            <br/>
            <!-- TODO - Query 10
            You will have to modify the approach below slightly to make each genre clickable
            -->
            <h3> Genres </h3>
            {% for instance in songmetadata %}
                {% if instance.md_type_name == 'song genre' %}
                    <div>
                        {{instance.md_value}}
                    </div>
                {% endif %}
            {% endfor %}
            <h3> Audio </h3>

            <audio controls id="audio">
                <source src="{{songLink[0].storage_location}}" type="audio/mp3" preload="auto">
              Your browser does not support the audio element.
              </audio>
              <input type="button" value="sound" onclick="togglePlay()" />
              <script>
                myAudio=document.getElementById('audio');
                function togglePlay() {
                    if (myAudio.paused) {
                        myAudio.play();
                    }
                    else {
                        myAudio.pause();
                        var br = document.createElement("br"); 
                        var form = document.createElement("form");
                        var progress_ = document.getElementById('audio').currentTime;
                        form.setAttribute("method", "post");
                        form.setAttribute("action", "{{url_for('update_progress', song_id=song[0].song_id, progress=progress_)}}");

                        var FN = document.createElement("input");
                        FN.setAttribute("type", "hidden");
                        FN.setAttribute("name", "current_time");
                        FN.setAttribute("value", myAudio.currentTime);
                        form.appendChild(FN);
                        form.appendChild(br.cloneNode());

                        var s = document.createElement("input");
                        s.setAttribute("type", "submit");
                        s.setAttribute("class", "flat");
                        form.appendChild(s);

                        document.getElementsByTagName("body")[0].appendChild(form);
                    }
                };

              </script>
        {% else %}
            <h2 class="title"> Invalid Song ID</h2>
        {% endif %}
    </div>
</div>
{% include 'bottom.html'%}
